<%- include('partials/header') %>



<div class="container mt-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">Manage Categories</h3>
    <a class="btn btn-outline-primary" href="/categories-summary">View Summary</a>
  </div>

  <div class="card p-4 shadow-sm border-0 mb-4">
    <h5 class="mb-3">Add New Category</h5>
    <form action="/categories/add" method="POST" class="row g-2 align-items-end">
      <div class="col-md-6">
        <label class="form-label">Category Name</label>
        <input class="form-control" name="name" placeholder="e.g. Food" required>
      </div>

      <div class="col-md-4">
        <label class="form-label">Monthly Limit (optional)</label>
        <input class="form-control" type="number" step="0.01" name="monthlyLimit" placeholder="e.g. 200">
      </div>

      <div class="col-md-2">
        <button class="btn btn-primary w-100">Add</button>
      </div>
    </form>
  </div>

  <div class="card p-4 shadow-sm border-0">
    <h5 class="mb-3">Your Categories</h5>

    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Name</th>
            <th style="width:220px;">Monthly Limit</th>
            <th style="width:160px;">Actions</th>
          </tr>
        </thead>

        <tbody>
          <% if (!categories || categories.length === 0) { %>
            <tr>
              <td colspan="3" class="text-muted">No categories yet.</td>
            </tr>
          <% } else { %>
            <% categories.forEach(c => { %>
              <tr>
                <td>
                  <span class="badge bg-secondary"><%= c.name %></span>
                </td>

                <td>
  <form action="/categories/update/<%= c._id %>" method="POST" class="d-flex gap-2 align-items-center">

    <input
      class="form-control form-control-sm"
      type="number"
      name="monthlyLimit"
      value="<%= c.monthlyLimit ?? '' %>"
      disabled
      id="limit-<%= c._id %>"
      style="width:90px"
    >

    <button
      type="button"
      class="btn btn-sm btn-outline-secondary"
      onclick="enableEdit('<%= c._id %>')"
    >
      Edit
    </button>

    <button type="submit" class="btn btn-sm btn-outline-primary">
      Save
    </button>

    <a
      href="/categories/delete/<%= c._id %>"
      class="btn btn-sm btn-outline-danger"
      onclick="return confirm('Delete this category?')"
    >
      Delete
    </a>

  </form>
</td>

  </form>
  <script>
  function enableEdit(id) {
    const input = document.getElementById('limit-' + id);
    input.disabled = false;
    input.focus();
  }
</script>



             
              </tr>
            <% }) %>
          <% } %>
        </tbody>
      </table>
    </div>
  </div>

</div>



<%- include('partials/footer') %>
